py_library(
  name = "main",
  srcs = [':setup'],
  visibility = ["//visibility:public"],
  imports = ['pycrypto_2_6_1/lib/python'],
)

genrule(
  name = "setup",
  outs = [
    'pycrypto_2_6_1/lib/python/Crypto/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_AES.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_ARC2.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_ARC4.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_Blowfish.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_CAST.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_DES.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_DES3.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/_XOR.so',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/AES.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/ARC2.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/ARC4.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/blockalgo.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/Blowfish.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/CAST.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/DES.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/DES3.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/PKCS1_OAEP.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/PKCS1_v1_5.py',
    'pycrypto_2_6_1/lib/python/Crypto/Cipher/XOR.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_MD2.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_MD4.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_RIPEMD160.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_SHA224.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_SHA256.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_SHA384.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/_SHA512.so',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/hashalgo.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/HMAC.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/MD2.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/MD4.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/MD5.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/RIPEMD.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/SHA.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/SHA224.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/SHA256.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/SHA384.py',
    'pycrypto_2_6_1/lib/python/Crypto/Hash/SHA512.py',
    'pycrypto_2_6_1/lib/python/Crypto/pct_warnings.py',
    'pycrypto_2_6_1/lib/python/Crypto/Protocol/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Protocol/AllOrNothing.py',
    'pycrypto_2_6_1/lib/python/Crypto/Protocol/Chaffing.py',
    'pycrypto_2_6_1/lib/python/Crypto/Protocol/KDF.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/_DSA.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/_RSA.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/_slowmath.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/DSA.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/ElGamal.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/pubkey.py',
    'pycrypto_2_6_1/lib/python/Crypto/PublicKey/RSA.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/_UserFriendlyRNG.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/Fortuna/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/Fortuna/FortunaAccumulator.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/Fortuna/FortunaGenerator.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/Fortuna/SHAd256.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/OSRNG/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/OSRNG/fallback.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/OSRNG/nt.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/OSRNG/posix.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/OSRNG/rng_base.py',
    'pycrypto_2_6_1/lib/python/Crypto/Random/random.py',
    'pycrypto_2_6_1/lib/python/Crypto/Signature/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Signature/PKCS1_PSS.py',
    'pycrypto_2_6_1/lib/python/Crypto/Signature/PKCS1_v1_5.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/__init__.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/_counter.so',
    'pycrypto_2_6_1/lib/python/Crypto/Util/_number_new.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/asn1.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/Counter.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/number.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/py21compat.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/py3compat.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/randpool.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/RFC1751.py',
    'pycrypto_2_6_1/lib/python/Crypto/Util/strxor.so',
    'pycrypto_2_6_1/lib/python/Crypto/Util/winrandom.py',
  ],

  cmd = """
    destdir="$$(pwd)/$(@D)";
    cd external/pycrypto/pycrypto-2.6.1;
    python setup.py build;
    python setup.py install --home="$${destdir}/pycrypto_2_6_1";
  """,
)  

